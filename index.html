<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Avis RSA-PMS — Performance Dashboard</title>
  <link rel="stylesheet" href="styles.css">
  <script>
    window.BACKEND_URL = "https://script.google.com/macros/s/AKfycbxdegGrWMt0YlWMic9BURoZPczXgWb4Cx5IiXmEp9hJcUpKwVKpNhHU9khNxTKfRX_-Yw/exec";
  </script>
  <style>
    .score{display:inline-block;padding:4px 8px;border-radius:8px;color:#fff;font-weight:600}
    .score-c0{background:#ef4444} .score-c1{background:#f2553d}
    .score-c2{background:#f56636} .score-c3{background:#f8772f}
    .score-c4{background:#fb8828} .score-c5{background:#fda821}
    .score-c6{background:#e7c91f} .score-c7{background:#c5da2a}
    .score-c8{background:#9ddd3f} .score-c9{background:#6ede56}
    .score-c10{background:#22c55e}
    .small{font-size:12px;color:#6b7280}
    .legend ul{margin:6px 0 0 18px}
  </style>
</head>
<body>
  <header>
    <div class="header-inner">
      <div class="brand">Avis RSA-PMS<span class="muted">— Performance Dashboard</span></div>
      <div class="row">
        <input id="search" class="searchbar" type="search" placeholder="Search associate…">
      </div>
    </div>
  </header>

  <div class="container">
    <!-- Date range controls -->
    <div class="card">
      <div class="row">
        <label>Start <input id="start" type="date"></label>
        <label>End <input id="end" type="date"></label>
        <button class="ghost" data-range="today">Today</button>
        <button class="ghost" data-range="yesterday">Yesterday</button>
        <button class="ghost" data-range="7">Last 7</button>
        <button class="ghost" data-range="30">Last 30</button>
        <span class="small" id="updated">Last updated —</span>
      </div>
    </div>

    <!-- Checklist reference -->
    <div class="card legend">
      <h3 style="margin:0 0 8px 0">Policy & Customer-First Checklist (reference)</h3>
      <p class="small" style="margin:0">Completion % is shown per RSA in the tables below.</p>
      <ul>
        <li>Greeted customer within 10 seconds</li>
        <li>Verified ID &amp; payment clearly</li>
        <li>Explained insurance options neutrally</li>
        <li>Explained fuel/EV policy accurately</li>
        <li>Offered upgrade only if beneficial</li>
        <li>Reviewed total cost before payment</li>
        <li>Closed courteously &amp; asked for questions</li>
      </ul>
    </div>

    <!-- Main table for selected range -->
    <div class="card">
      <h3 style="margin:0 0 10px 0">Selected Range</h3>
      <table class="table">
        <thead>
          <tr>
            <th>Associate</th>
            <th>Overall</th>
            <th>CI</th>
            <th>UC</th>
            <th>PK</th>
            <th>TE</th>
            <th>EF</th>
            <th>TC</th>
            <th>Checklist %</th>
            <th>Customers</th>
            <th>Last Rated</th>
          </tr>
        </thead>
        <tbody id="tbody"></tbody>
      </table>
      <p id="empty" class="note" style="margin:8px 0 0">No data for selected range.</p>
    </div>

    <!-- Weekly ALL RSAs -->
    <div class="card">
      <h3 style="margin:0 0 10px 0">Weekly — ALL RSAs</h3>
      <table class="table">
        <thead>
          <tr>
            <th>Associate</th>
            <th>Overall</th>
            <th>CI</th>
            <th>UC</th>
            <th>PK</th>
            <th>TE</th>
            <th>EF</th>
            <th>TC</th>
            <th>Checklist %</th>
            <th>Customers</th>
            <th>Last Rated</th>
          </tr>
        </thead>
        <tbody id="weeklyBody"></tbody>
      </table>
      <p class="note" id="weeklyNote" style="margin:8px 0 0">—</p>
    </div>

    <!-- Monthly ALL RSAs -->
    <div class="card">
      <h3 style="margin:0 0 10px 0">Monthly — ALL RSAs</h3>
      <table class="table">
        <thead>
          <tr>
            <th>Associate</th>
            <th>Overall</th>
            <th>CI</th>
            <th>UC</th>
            <th>PK</th>
            <th>TE</th>
            <th>EF</th>
            <th>TC</th>
            <th>Checklist %</th>
            <th>Customers</th>
            <th>Last Rated</th>
          </tr>
        </thead>
        <tbody id="monthlyBody"></tbody>
      </table>
      <p class="note" id="monthlyNote" style="margin:8px 0 0">—</p>
    </div>
  </div>

  <script src="results.js"></script>
</body>
</html>
